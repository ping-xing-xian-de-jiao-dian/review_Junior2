<img src="嵌入式.assets/image-20220228190607346.png" alt="image-20220228190607346" style="zoom:80%;" />

五五开，开卷

arm汇编、模式，NEON指令，驱动程序测试程序设计等



---



嵌入式最常用：GPIO（通用输入 / 输出接口）

**作业1：PXA270有个（119）GPIO管脚（课程平台看手册，注意型号要一样）**

答：Although the PXA27x processor has 121 GPIO pins, **only 119 are bonded out in the PXA270 processor**. All 121 GPIOs are available in the PXA271, PXA272 processors. Additionally, five of these GPIOs have dedicated functions and are not available as GPIOs.



局部译码：A~0~\~A~25~取三条线，分情况选不同的线

可测试的设计方法：备用片选线（写了OPEN，表示开路不连）先不用，如果出问题了再用，把0Ω的电阻焊到别的线上

<img src="嵌入式.assets/image-20220228203138782.png" alt="image-20220228203138782" style="zoom:80%;" />



指令缓存、数据缓存

MMU（memory management unit）：虚实地址变换、内存地址访问保护



### ARM模式

<img src="嵌入式.assets/image-20220228211111509.png" alt="image-20220228211111509" style="zoom:90%;" />

**用户模式**最安全的，编写应用程序一般用这个

<img src="嵌入式.assets/image-20220228211303589.png" alt="image-20220228211303589" style="zoom:90%;" />

**异常模式**

<img src="嵌入式.assets/image-20220228212315385.png" alt="image-20220228212315385" style="zoom:90%;" />

**系统模式（特权模式）**

状态切换用指令，模式切换比较复杂（中断等）



#### 寄存器

R0~R7是未分组寄存器

<img src="嵌入式.assets/image-20220228213703667.png" alt="image-20220228213703667" style="zoom:80%;" />

快中断多了R8\~R12_flq，用的是这些，所以中断返回时R8\~R12寄存器的值都不会变



### 第一次作业

<img src="嵌入式.assets/image-20220307193400886.png" alt="image-20220307193400886" style="zoom:80%;" />

CPSR（M4~M0）取到R0，原来是什么模式？（一加电或一复位时是管理模式，这里是.c->.s，取决于设置，不同环境不一样）

把R0的一些位清零，立即数为1的那些位

把R0的一些位变1，立即数为1的那些位（修改成系统模式）

返送回去，CPSR分为了几段，写CPSR_c是为了不影响其它位



<img src="嵌入式.assets/image-20220307193422875.png" alt="image-20220307193422875" style="zoom:80%;" />

多寄存器操作（起始地址8000 0000）：

伪指令，把立即数赋值给了R0

如果超过一定位数就不能用MOV了

把r1存储到以r0存的数为地址的地方



选择性，每个做一到两个

用户模式能不能返回特权模式
